<!DOCTYPE html>
<html lang="en" xml:lang="en"><head><title>Full and Legal ranges</title> 
<meta charset="utf-8"/> 
<meta content="TeX4ht (http://www.tug.org/tex4ht/)" name="generator"/> 
<meta content="width=device-width,initial-scale=1" name="viewport"/> 
<link href="cinematic-color.css" rel="stylesheet" type="text/css"/> 
<meta content="cinematic-color.tex" name="src"/> 
 <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.6.1/react.min.js" type="text/javascript"></script> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.6.1/react-dom.min.js" type="text/javascript"></script> 
<script src="https://cdn.rawgit.com/mrdoob/three.js/master/build/three.min.js" type="text/javascript"></script> 
<script src="https://cdn.rawgit.com/mrdoob/three.js/master/examples/js/controls/OrbitControls.js" type="text/javascript"></script> 
<script src="https://cdn.rawgit.com/mrdoob/three.js/master/examples/js/controls/TrackballControls.js" type="text/javascript"></script> 
<script src="https://rawgit.com/colour-science/colour-analysis-three.js/master/dist/colour-analysis.js" type="text/javascript"></script> 
<script src="assets/js/jeri/jeri.min.js" type="text/javascript"></script> 
<script type="text/javascript"> 
window.colourAnalysisServer = 'https://www.colour-science.org:8020'; 
</script> 
<script type="text/javascript"> 
(function() { 
var cx = '000762316508951405781:qrigrsppwri'; 
var gcse = document.createElement('script'); 
gcse.type = 'text/javascript'; 
gcse.async = true; 
gcse.src = 'https://cse.google.com/cse.js?cx=' + cx; 
var s = document.getElementsByTagName('script')[0]; 
s.parentNode.insertBefore(gcse, s); 
})(); 
</script> 
</head><body><nav class="navbar navbar-expand-md navbar-light bg-light">
<a class="navbar-brand" href="#">Cinematic Color 2</a>
<button aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#navbarSupportedContent" data-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbar">
<ul class="navbar-nav mr-auto"><li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="preface.html" id="preface" role="button">Preface</a><div aria-labelledby="preface" class="dropdown-menu"><a class="dropdown-item" href="description.html">Description</a><a class="dropdown-item" href="authorship.html">Authorship</a><a class="dropdown-item" href="on-the-web.html">On the Web</a></div></li><li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="introduction.html" id="introduction" role="button">Introduction</a><div aria-labelledby="introduction" class="dropdown-menu"><a class="dropdown-item" href="intended-audience.html">Intended Audience</a><a class="dropdown-item" href="how-to-read-this-document.html">How to Read this Document</a><a class="dropdown-item" href="the-goal.html">The Goal</a><a class="dropdown-item" href="converging-approaches.html">Converging Approaches</a><a class="dropdown-item" href="a-general-model-of-color-processing.html">A General Model of Color Processing</a><a class="dropdown-item" href="color-management-challenges.html">Color Management Challenges</a></div></li><li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="color-science.html" id="color-science" role="button">Color Science</a><div aria-labelledby="color-science" class="dropdown-menu"><a class="dropdown-item" href="about-color-science.html">About Color Science</a><a class="dropdown-item" href="electromagnetic-spectrum.html">Electromagnetic Spectrum</a><a class="dropdown-item" href="human-visual-system.html">Human Visual System</a><a class="dropdown-item" href="basic-colorimetry.html">Basic Colorimetry</a><a class="dropdown-item" href="advanced-colorimetry.html">Advanced Colorimetry</a><a class="dropdown-item" href="representing-color.html">Representing Color</a><a class="dropdown-item" href="color-imaging-systems.html">Color Imaging Systems</a></div></li><li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="workflow.html" id="workflow" role="button">Workflow</a><div aria-labelledby="workflow" class="dropdown-menu"><a class="dropdown-item" href="about-workflow.html">About Workflow</a><a class="dropdown-item" href="academy-color-encoding-system-aces.html">Academy Color Encoding System (ACES)</a><a class="dropdown-item" href="the-look.html">The Look</a><a class="dropdown-item" href="on-set.html">On Set</a><a class="dropdown-item" href="visual-effects-animation-and-games.html">Visual Effects, Animation and Games</a><a class="dropdown-item" href="compositing.html">Compositing</a><a class="dropdown-item" href="di-grading.html">DI Grading</a><a class="dropdown-item" href="critical-monitoring.html">Critical Monitoring</a><a class="dropdown-item" href="finishing.html">Finishing</a><a class="dropdown-item" href="archives.html">Archives</a></div></li><li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="appendix.html" id="appendix" role="button">Appendix</a><div aria-labelledby="appendix" class="dropdown-menu"><a class="dropdown-item" href="common-rgb-color-encodings.html">Common RGB Color Encodings</a><a class="dropdown-item" href="opencolorio-ocio.html">OpenColorIO (OCIO)</a><a class="dropdown-item" href="colour-science-for-python.html">Colour Science for Python</a><a class="dropdown-item" href="luts-and-transforms.html">LUTs and Transforms</a><a class="dropdown-item" href="asc-cdl.html">ASC CDL</a><a class="dropdown-item" href="aces-ctl.html">ACES CTL</a><a class="dropdown-item" href="full-and-legal-ranges.html">Full and Legal ranges</a><a class="dropdown-item" href="color-difference-encoding.html">Color Difference Encoding</a><a class="dropdown-item" href="camera-characterization.html">Camera Characterization</a><a class="dropdown-item" href="file-formats.html">File Formats</a><a class="dropdown-item" href="color-matching-experiments.html">Color Matching Experiments</a><a class="dropdown-item" href="grassmann-s-law-of-additive-color-mixture.html">Grassmann's Law of Additive Color Mixture</a><a class="dropdown-item" href="software.html">Software</a><a class="dropdown-item" href="acknowledgements.html">Acknowledgements</a></div></li><li class="nav-item"><a class="nav-link" href="glossary.html">Glossary</a></li><li class="nav-item"><a class="nav-link" href="bibliography.html">Bibliography</a></li></ul>
<form class="navbar-form navbar-right" id="cse-search-box-form-id" onsubmit="return executeSearchQuery();" role="search">
<div class="input-group">
<input autocomplete="on" class="form-control" id="cse-search-input-box-id" size="25" type="text"/>
<script async="" src="https://cse.google.com/cse/brand?form=cse-search-box-form-id&amp;inputbox=cse-search-input-box-id" type="text/javascript">
</script>
<span class="input-group-btn">
<button class="btn btn-default" type="submit">
<span class="glyphicon glyphicon-search"></span>
</button>
</span>
</div>
</form>
</div>
</nav><gcse:searchresults-only></gcse:searchresults-only> 
<link href="assets/css/bootstrap/bootstrap.min.css" rel="stylesheet" type="text/css"/> 
<link href="assets/css/custom.css" rel="stylesheet" type="text/css"/> 

 <article class="page-content"> <div class="container-fluid py-3"> 
<div class="row"> 
<div class="col-md-2"></div> 
<div class="col-md-8"> 
 <h3 class="sectionHead"><span class="titlemark">4.7   </span> <a href="cinematic-color.html#QQ2-40-165" id="x40-1640004.7">Full and Legal ranges</a></h3>
   
<h4 class="subsectionHead"><span class="titlemark">4.7.1   </span> <a href="contents.html#QQ2-40-166" id="x40-1650004.7.1">Legal Range</a></h4>
<p class="noindent">When image data is stored or transmitted in an integer form, such as DPX files or over
SDI signals, it is necessary to map the levels in the image to the available code values.
When digital representation of video signals was devised, it was decided to allow for
overshoot and undershoot outside the range from black to white, in order not to clip
analog signals which might not sit accurately within that range. Thus it was decided that
black should be coded as 8 bit 16 or 10 bit 64, and white should be coded
as 8 bit 235 or 10 bit 940. This coding is referred to by a number of names,
including Legal Range, SMPTE Range, Narrow Range, Video Range, and Head
Range. The mapping from an output referred float representation (v) where
display black is represented by 0.0 and display white by 1.0 can be generalized as
follows:
</p><p class="indent">   legal = round(2(n - 8) ? (16 + 219 ? v))
</p><p class="indent">   where n is the encoding bit depth.
</p>   
<h4 class="subsectionHead"><span class="titlemark">4.7.2   </span> <a href="contents.html#QQ2-40-167" id="x40-1660004.7.2">Full Range</a></h4>
<p class="noindent">The alternative is simply to use all the available integer code values to encode the range
from black to white. This approach is unable to represent so-called "super-white" and
"sub-black" (or "super-black" - a contradiction in terms, because the Latin prefix "super"
means "above") values. This coding is referred to as Full Range, Data Range or CG
Range. It is also sometimes confusingly called RGB Range, due to to the fact that
Y’CbCr coding uses legal range to code the Y’ signal, so RGB is deemed to use the
alternate coding, even though this is not always the case. Full range coding can be
generalized as:
</p><p class="indent">   full = round(v ? (2n - 1))
</p><p class="indent">   where again n is the encoding bit depth.
</p><p class="indent">   A third encoding exists which uses the range from 64-1023 in 10 bit to encode the
signal. This is sometimes called Extended Range coding or SMPTE+, and is sometimes
used for HLG, although the term Extended Range may also be used to refer to Full Range
coding. This kind of ambiguity regarding terminology makes discussion of the issues
related to range complex. For the sake of simplicity, this document will ignore Extended
Range, as that relates primarily to broadcast video. For completeness, the equation for
SMPTE+ is given here:
</p><p class="indent">   SMPTE+ = 2(n - 4) + v ? (2n ? 2(n - 4) ? 1)
                                                                  

                                                                  
</p><p class="indent">   where n is the bit depth, and v is the 0.0-1.0 normalized HLG signal being encoded,
for example.
</p><p class="indent">   Even when discussing full and legal range there is still the possibility for confusion, as
some applications use the two terms to mean the opposites of the definitions given here.
And also, for example, when choosing the ’legal’ option in an application it is
important to understand whether this means that the image data is to be ’treated
as’ legal range or ’scaled to’ legal range. Some additional confusion is caused
by the fact that because of the overshoot and undershoot capabilities of legal
range coding, it is able to code ’illegal’ pixel values - that is values outside the
0-100
</p><p class="indent">   These codings date back to the early days of digital video, where the analog signals
being coded had specific meanings for ’black’ and ’white’ in terms of video level. When
using an integer coding to represent a log signal, the log values 0.0 and 1.0 no longer
have particular significance, and their meaning varies between the different log codings.
The reference 10 bit code values of a log signal are those which are created in a DPX
exported from the manufacturer’s raw decoding software, but the way those values
are mapped to the SDI code values output by the camera (and hence also the
values stored in Y’CbCr based recording formats such as ProRes) varies between
manufacturers.
</p><p class="indent">   ARRI, for example, have chosen to map their LogC coding to the legal range of the
SDI output of their cameras (previously there was a menu option to map it to full range -
which was referred to as ’Extended’ - but this is no longer available) and to do the same
with the code values sent to the ProRes encoders in their cameras. Because
during decoding most software ProRes decoders apply a legal to full scale to
the legal range values used internally in ProRes, lens cap black will appear as
9.3
</p><p class="indent">   Sony, on the other hand, maps their cameras’ S-Log3 encoding to the entire range of
code values available on the SDI output of the camera, and send the same value to the
encoders for their internal recordings. So S-Log3 lens cap black will appear at
3.5
</p><p class="indent">   Correct linearization, using ACES Input Transforms, for example, is reliant upon the
image data input to the transform being appropriately scaled. A ProRes log recording
from a Sony (or Canon or Panasonic) camera is one of the situations where errors are
likely to occur. If an S-Log3 ProRes recording is handled in the standard manner, which is
appropriate for an ARRI or RED recording, a legal to full scale will be applied (possibly
automatically and invisibly by the decoding software, as happens in Nuke for
example) inappropriately, meaning that the sensor black level will be mapped
to too low a code value, resulting in negative values after linearization. It is
important to look out for this, as the result may not be immediately apparent,
simply resulting in slightly crushed shadows when viewed through the display
transform.
</p><p class="indent">   There is further complexity caused by the fact that in ’baked video’ modes Sony
cameras map the video black to the white range to the legal range of the SDI output and
internal recordings. This means that different scaling is required in post for log and video
recordings. Sony’s proprietary internal recording formats contain metadata, identifying
the image data as log or baked video, and some applications are able to automatically
scale the decode based on this. However, it is always worthwhile checking that
scaling has been applied correctly. Most ProRes decoders have no way of knowing
whether the recorded image is S-Log3 or baked video (ProRes recordings will
often come from external recorders, which simply receive an SDI signal with
                                                                  

                                                                  
no information about the content) so it is up to the user to set the correct
scaling.
</p><p class="indent">   Avid software is unusual in decoding ProRes without scaling, so LogC black will
appear by default as 0.116 (8 bit code value 30) in the Avid UI. But because no scaling is
applied to SDI output from Avid, the signal will still be at 9.3
</p><p class="indent">   Hardware LUT boxes or LUT processors built into monitors apply simple 3D cubes,
without shaper LUTs or defined input domains. They, therefore, map an input
range from 0-1 to an output range of 0-1, but it varies from device to device
whether this 0-1 range is mapped from the full range 0-1023 SDI code values at
the input of the LUT box, or the 64-940 legal range within those code values.
Likewise, the 0-1 output of the LUT will normally be mapped to output SDI
code values using an inverse of the input scaling. Some LUT boxes have control
software which allows the user to select input and output scaling, but many work
in only one mode, and it is often not clearly documented what that mode is.
Therefore when building a LUT to be applied in a hardware LUT box, it is vital to
ascertain what mapping the LUT box uses. Often this can only be done by
loading specifically designed LUTs (such as LUTs where every table value is
equal to 940/1023) into the LUT box and checking the output on a waveform
monitor.
</p><p class="indent">   In conclusion, it is crucial that you check your pipeline to ensure that any scaling
between legal and full range is only being applied where necessary, and is happening in
the correct direction. Look out also for "double scaling" where a scale is applied
unnecessarily because one has already been applied invisibly by the application. Part of
the round trip testing that you should always perform is to make sure that any scaling
applied at the start of the VFX pipeline is inverted at the end of it so that what is passed
to DI matches the original media, if it is sent in the original format. If sent as
scene-referred linear EXR files they must match the result of a linearization performed
in the DI system on the original media, using an ACES Input Transform for
example. Equally, it is important to confirm that color baked renders for editorial
match the graded dailies of the original plates. Due to the different handling of
range scaling by different NLEs, and the options for the editor to change the
interpretation of the files, the only way to be certain of this is by thorough
testing.
</p><p class="indent">   Output-referred image shown as intended
</p><p class="indent">   (b) The same image with a full-to-legal scale inappropriately applied. Note the raised
blacks and clipping below peak white.
</p><p class="indent">   (c) The same image with a legal-to-full scale inappropriately applied. Both whites and
blacks are clamped.
                                                                  

                                                                  
</p>   
<div class="breadcrumb-navigation text-center"><a href="aces-ctl.html"><button class="btn btn-light mx-3" type="button">Previous</button></a><a href="appendix.html#full-and-legal-ranges.html"><button class="btn btn-light mx-3" type="button">Up</button></a><a href="color-difference-encoding.html"><button class="btn btn-light mx-3" type="button">Next</button></a></div>   </div> 
<div class="col-md-2"></div> 
</div> 
</div> 
</article>  <footer class="page-footer"> 
<div class="container-fluid text-center py-3"> 
Copyright © 2012-2019 ‐ Cinematic Color Authors ‐ 
<a href="mailto:ves-tech-color@googlegroups.com"> 
ves-tech-color@googlegroups.com</a> 
</div> 
</footer>  <script src="assets/js/jquery/jquery.min.js" type="text/javascript"></script> 
<script src="assets/js/popper/popper.min.js" type="text/javascript"></script> 
<script src="assets/js/bootstrap/bootstrap.min.js" type="text/javascript"></script> 
<script type="text/javascript"> 
function executeSearchQuery() { 
var input = document.getElementById('cse-search-input-box-id'); 
var element = google.search.cse.element.getElement('searchresults-only0'); 
if (input.value == '') { 
element.clearAllResults(); 
} else { 
element.execute(input.value); 
} 
return false; 
} 
</script> 
 
 
</body></html>